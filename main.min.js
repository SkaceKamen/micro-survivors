function microSurvivors(L=document.body,m=400,s=400){let O="monospace",U=()=>["WASD to move",y.Y[0].K===Le?"Mouse to aim":void 0,"Survive","Kill end boss"],o=m/2,p=s/2,{floor:c,ceil:C,random:Q,round:Z,cos:q,sin:F,min:j,hypot:h,abs:z,atan2:M,PI:J,max:ee,tan:ae,sign:W}=Math,N=2*J;var e="Press ENTER to ";let B=e+"restart",n="center",l="top",Y="left",H="right",K="middle",g="#fff",$="#aaa",G="#ccc",t="#faa",V="#0ac",d="#999",{entries:X,assign:_}=Object,re=0;let te=!1,se=.3,ne=new AudioContext,u=(e=1,a=.05,r=220,t=0,s=0,n=.1,d=0,W=1,l=0,i=0,o=0,p=0,m=0,N=0,c=0,B=0,h=0,g=1,u=0,v=0,f=0)=>{let k=2*J,R=44100,Y=l*=500*k/R/R,b=r*=(1-a+2*a*Q(a=[]))*k/R,S=0,H=0,x=0,D=1,K=0,$=0,A=0,w=f<0?-1:1,y=k*w*f*2/R,P=q(y),E=F,T=E(y)/4,I=1+T,G=-2*P/I,V=(1-T)/I,L=(1+w*P)/2/I,X=-(w+P)/I,_=L,O=0,U=0,C=0,M=0;for(t=R*t+9,u*=R,s*=R,n*=R,h*=R,i*=500*k/R**3,c*=k/R,o*=k/R,p*=R,m=R*m|0,e*=se,w=t+u+s+n+h|0;x<w;a[x++]=A*e)++$%(100*B|0)||(A=d?1<d?2<d?3<d?E(S**3):ee(j(ae(S),1),-1):1-(2*S/k%2+2)%2:1-4*z(Z(S/k)-S/k):E(S),A=(m?1-v+v*E(k*x/m):1)*(A<0?-1:1)*z(A)**W*(x<t?x/t:x<t+u?1-(x-t)/u*(1-g):x<t+u+s?g:x<w-h?(w-x-h)/n*g:0),A=h?A/2+(h>x?0:(x<w-h?1:(w-x)/h)*a[x-h|0]/2/e):A,f&&(A=M=_*O+X*(O=U)+L*(U=A)-V*C-G*(C=M))),y=(r+=l+=i)*q(c*H++),S+=y+y*N*E(x**5),D&&++D>p&&(r+=o,b+=o,D=0),!m||++K%m||(r=b,l=Y,D=D||1);(e=ne.createBuffer(1,w,R)).getChannelData(0).set(a),(r=ne.createBufferSource()).buffer=e,r.connect(ne.destination),r.start()},v={Ne:[3,,42,.01,.01,.02,3,2,,2,,,,,193,.6,,.53,.02],Ue:[.2,,577,,.05,.09,,3.6,,,,,,,,,,.64,.03,,-1499],We:[.6,,599,.06,.11,.17,,1.2,-1,-5,254,.06,.1,.1,12,,,.86,.25,,-972],Be:[.3,,142,,.23,.5,1,,-2.6,-24,,,.09,,,,,.1,.06],Ce:[.7,,480,.02,.04,.18,3,2.3,,,,,,.6,,.4,,.85,.01,,99]},de=(e,a=2,r="0")=>e.toString().padStart(a,r),le=e=>de(c(e/60))+":"+de(c(e%60)),ie=e=>i(e*(180/J))+"Â°",i=(e,a=0)=>e?.toFixed(a)??"",oe=e=>i(e,2),pe=(e,a,r)=>{for(var t=[];e.length&&a--;){var s=me(e,r);t.push(e[s]),e.splice(s,1)}return t},me=(r,t)=>{var e=r.map(t).reduce((e,a)=>e+a),s=Q()*e;for(let e=0,a=0;;e++)if(s<=(a+=t(r[e])))return e},ce=(e,a)=>{let r=0;for(var t of a)e.splice(t-r,1),r+=1},he=e=>b.fillStyle=e,f=(e,a,r,t,s,n)=>{he(s),b.fillRect(e,a,r,t),n&&(b.strokeStyle=n,b.strokeRect(e,a,r,t))},ge=(e="#000d")=>{f(0,0,m,s,e)},ue=(e,a,r,t)=>{he(t),b.fillRect(e-r/2,a-r/2,r,r)},ve=(e,a,r,t)=>{he(t),b.beginPath(),b.moveTo(e,a-r/2),b.lineTo(e-r/2,a+r/2),b.lineTo(e+r/2,a+r/2),b.fill()},k=(e,a,r,t,s=Y,n=l,d=14)=>{b.font=d+"px "+O,he(t),b.textAlign=s,b.textBaseline=n,b.fillText(r,e,a)},fe=(e,a)=>{k(o,e,a,g,n,l)},R=(e,a,r,t)=>{he(t),b.beginPath(),b.arc(e,a,r,0,N),b.fill()},ke=e=>b.globalAlpha=e,Re=(e,a,r,t,s,n=!0)=>{var d,l,i=a,o=n?r/2:r;n&&15*(s.length-1)<=t&&(e+=r/4);for([d,l]of s)(d||l)&&(k(e,a,d+":",$),k(e+o-5,a,""+l,g,H)),i+t<(a+=15)&&(a=i,e+=o);return a},be=(e,a,r)=>{e=b.createRadialGradient(o,p,e,o,p,o);return e.addColorStop(0,a),e.addColorStop(1,r),e},r=document.createElement("canvas"),b=(r.width=m,r.height=s,r.getContext`2d`),Se={38:"u",40:"d",37:"l",39:"r",87:"u",83:"d",65:"l",68:"r",13:"e",69:"e",27:"p",80:"p"},S={u:!1,d:!1,l:!1,r:!1,e:!1,p:!1,Ye:0,Ve:0,ta:!1,Je:0,Qe:0,Ze:0,ea:0},xe=60,x={},De=e=>e.preventDefault();e=r=>e=>{var a=Se[e.which];a&&(De(e),S[a]=r,x[a]=r)};let Ae=e=>{var a=r.getBoundingClientRect();return{x:(e.clientX-a.left)*(1/re),y:(e.clientY-a.top)*(1/re)}};onkeydown=e(!0),onkeyup=e(!1),onmousemove=e=>{e=Ae(e);S.Ye=e.x,S.Ve=e.y},onblur=()=>{E.ge===P.Oe&&(E.ge=P.le)};e=(e,a)=>r.addEventListener(e,a,{passive:!1});e("touchstart",e=>{var a=Ae(e.touches[0]);S.ta=!0,x.ta=!0,S.Ze=S.Je=a.x,S.ea=S.Qe=a.y,te=!0,De(e)}),e("touchmove",e=>{var a=Ae(e.touches[0]);S.Ze=a.x,S.ea=a.y,De(e)}),ontouchend=()=>S.ta=!1;let we={h:"damage",g:"area",v:"speed",Ee:"orbs",S:"radius",_e:"angle"},ye={v:e=>ie(e)+"/s",_e:ie};e=e=>{let r=e[0];return e.map((e,a)=>0===a?r:(a=X(e).map(([e,a])=>`+${(ye[e]??i)(a-r[e])} `+we[e]).join(", "),{...r={...r,...e},q:a}))};let Pe=0,Ee=(e,a,r,t=20)=>{e.T-=a,e.P=.1,t&&(e.He=[q(r)*t,F(r)*t]),Pe++<4&&u(...v.Be),E.I+=a},Te=(e,a,r,t)=>{for(var s of T){var n=s.x-(r??y.x),d=s.y-(t??y.y),l=h(n,d),d=M(d,n);l<e+(s.K.S??5)&&a(s,d,l)}},Ie=(a,e,r)=>{var t=a.g,s=e*(a.v*(2-y.C.$.A)),n=N/a.Ee;for(let e=0;e<a.Ee;e++){var d=s+n*e;r(y.x+q(d)*t,y.y+F(d)*t,d)}};var a={l:"Orbs",u:e([{h:10,g:50,v:J/1.5,R:.1,Ee:1,S:10,q:"Orbiting orbs"},{Ee:2},{h:15,v:J/1.25},{v:+J,S:15},{Ee:3},{h:20},{Ee:4}]),D(e,a){let t=a.h+y.C.h.A,s=a.S*y.C.g.A;Ie(a,e.D,(e,a,r)=>Te(s/2,e=>Ee(e,t,r),e,a))},N(e,a){let r=a.S*y.C.g.A;Ie(a,e.D,(e,a)=>R(e,a,r/2,g))}};let Le={l:"Sword",u:e([{h:8,_e:J/4,g:80,R:.5,q:"Melee weapon"},{h:13},{_e:J/4*1.2,g:90},{h:18},{h:23},{h:28,_e:J/4*1.5},{h:33,_e:J/4*1.7,g:120}]),D(e,a){let t=a.h+y.C.h.A,s=a._e/2*y.C.g.A;Te(a.g,(e,a,r)=>{r=M((e.K.S??5)/2,r);z((a-y.L+J)%N-J)<s+r&&Ee(e,t,a)})},N(e,a){var r=a.R*y.C.$.A,t=a.g,e=.2*(e.M/r);0<e&&(r=a._e/2*y.C.g.A,he(`rgba(255,255,255,${e})`),b.beginPath(),b.moveTo(y.x,y.y),b.lineTo(y.x+q(y.L-r)*t,y.y+F(y.L-r)*t),b.arc(y.x,y.y,t,y.L-r,y.L+r),b.lineTo(y.x,y.y),b.fill())}};e={l:"Barbed Wire",u:e([{g:40,h:2,R:.75,q:"Area damage"},{g:60},{h:3},{g:70},{g:80},{h:4}]),D(e,a){let r=a.h+y.C.h.A;a=a.g*y.C.g.A;Te(a,(e,a)=>Ee(e,r,a,0))},N(e,a){var r=a.R*y.C.$.A,a=a.g*y.C.g.A,e=e.M/r,r=.15+.04*q(2*e*J);R(y.x,y.y,a,`rgba(255,0,0,${r})`)}};let Oe=e=>({K:e,D:0,M:0,W:0}),D=[{l:"Warrior",Ke:Le,C:{T:75,G:45,H:.05,V:50,h:0,$:1,j:.01,De:1,g:1},ye:{G:.2,H:.025,h:.3},N:(e,a)=>ue(e,a,10,g)},{l:"Monk",Ke:e,C:{T:75,G:60,H:.05,V:50,h:0,$:1,j:.01,De:0,g:1},ye:{H:.03,V:1,g:.025},N:(e,a)=>ve(e,a,10,g)},{l:"Magic Man",Ke:a,C:{T:75,G:45,H:.05,V:50,h:0,$:1,j:.01,De:0,g:1},ye:{G:.2,$:-.026,H:.03,De:.25,g:.02},N:(e,a)=>R(e,a,5,g)}],Ue=100;var A=a=>({l:a.l,q:()=>{var e=y.Y.find(e=>e.K===a);return a.u[(e?.W??-1)+1].q??""},X(){var e=y.Y.find(e=>e.K===a);e?e.W++:y.Y.push(Oe(a))},Ae:()=>y.Y.some(e=>e.K===a)?Ue:15,_:a.u.length-1});let Ce=[{l:"Speed boost",q:"+5% speed",X(){y.C.G.J+=.05}},{l:"Speed base",q:"+1 base speed",X(){y.C.G.Z+=1}},{l:"Max health",q:"+25 max health, +5 health",X(){y.C.T.Z+=25,y.T+=5}},{l:"Health drop",q:"+1% health drop chance",X:()=>y.C.j.Z+=.01},{l:"Regen",q:"+0.05/s health regen",X:()=>y.C.H.Z+=.05},{l:"Regen boost",q:"+10% health regen",X:()=>y.C.H.J+=.1},{l:"Pickup range",q:"+10 pickup range",X:()=>y.C.V.Z+=10},{l:"Damage",q:"+1 damage",X:()=>y.C.h.Z+=1},{l:"Attack speed",q:"+5% attack speed",X:()=>y.C.$.Z-=.05},{l:"Armor",q:"+1 armor",X:()=>y.C.De.Z+=1},{l:"Area",q:"+10% area",X:()=>y.C.g.Z+=.1},A(a),A(Le),A(e)],w=(e=0,a=0,r=1)=>({Z:e,J:r,get A(){return(this.Z+y.W*a)*this.J}}),Me=e=>({K:e,x:0,y:0,W:0,re:0,te:5,T:e.C.T,se:0,ne:0,oe:0,L:0,ze:0,Xe:0,C:{T:w(e.C.T,e.ye.T),H:w(e.C.H,e.ye.H),De:w(e.C.De,e.ye.De),h:w(e.C.h,e.ye.h),$:w(e.C.$,e.ye.$),g:w(e.C.g,e.ye.g),G:w(e.C.G,e.ye.G),V:w(e.C.V,e.ye.V),j:w(e.C.j,e.ye.j)},me:[],Y:[Oe(e.Ke)]}),y=Me(D[0]),P={Oe:0,de:1,ie:2,le:3,Le:4,pe:5,Pe:6},We={ce:-1,Te:0,I:0,ue:0,he:0,me:[],Ie:0,Me:0},E={ge:P.pe,...We},Ne=e=>_(y,Me(e));var a=(e,n)=>(r,t,s)=>e.map((e,a)=>ue(r+2*a,t+2*a,n,s??e)),A=(e,n)=>(r,t,s)=>e.map((e,a)=>ve(r+2*a,t+2*a,n,s??e)),e=(e,n)=>(r,t,s)=>e.map((e,a)=>R(r+2*a,t+2*a,n,s??e)),Be={T:10,G:26,h:8,re:1,N:a([$],10)},Ye={T:50,G:26,h:12,re:2,N:a([$,t],10)},He={T:100,G:30,h:15,re:3,N:a([$,t,"#4a4"],10)},Ke={T:1e3,G:30,h:15,re:100,S:20,N:a([t],20),ve:!0},a={T:100,G:16,h:6,re:1,N:a([d],10)},$e={T:20,G:35,h:8,re:2,N:A([d],10)},Ge={T:40,G:35,h:10,re:3,N:A([d,V],10)},Ve={T:60,G:35,h:12,re:4,N:A([d,V,"#966"],10)},Xe={T:220,G:20,h:10,re:4,N:A([d,d,d],10)},A={T:3e3,G:35,h:20,re:200,ve:!0,Re:80,S:10,N:A([t],20)},_e={T:10,G:40,h:8,re:3,N:e([d],5)},qe={T:20,G:40,h:10,re:4,N:e([d,V],5)},Fe={T:50,G:40,h:12,re:5,N:e([d,V,"#4ca"],5)},je={T:200,G:25,h:12,re:4,S:8,N:e([V],8)},e={T:5e3,G:50,h:25,re:300,ve:!0,Re:80,S:15,N:e([t],15)};let ze=(r,e,t=1)=>Array.from({length:c((e-r)/t)}).map((e,a)=>a*t+r);var Je,Qe=r=>()=>{var e=2*(r.S??5),a=ze(y.x-o,y.x+o,4+e),e=ze(y.y-p,y.y+p,4+e);a.map(e=>ra(e,y.y-p,r)),a.map(e=>ra(e,y.y+p,r)),e.map(e=>ra(y.x-o,e,r)),e.map(e=>ra(y.x+o,e,r))};let Ze=[{be:[Be]},{be:[Be,$e]},{be:[$e,_e],ve:Ke},{be:[$e,_e]},{be:[Ye],ke:Qe(a)},{be:[Ye,Ge,_e]},{be:[Ge,_e],ve:A},{be:[Ye,Ge,qe]},{be:[qe,He],ke:(Je=je,()=>{var e=N/40;ze(0,N,e).map(e=>ra(y.x+q(e)*o,y.y+F(e)*p,Je))})},{be:[He,Ve]},{be:[He,Ve]},{be:[He,Ve,Fe]},{be:[He,Ve],ve:e},{be:[He,Ve,Fe],xe:.1,ke:Qe(Xe)},{be:[],ve:{T:8e3,G:65,h:55,re:0,ve:!0,Re:1e3,S:25,N(e,a,r){R(e,a,25,r??t),ue(e,a,25,r??V),ve(e,a,23,r??t)}}}],ea=600,aa=ea/(Ze.length-1),ra=(e,a,r)=>T.push({x:e,y:a,K:r,T:r.T,M:0,He:[0,0],P:0,ve:!!r.ve}),T=[],ta=[],I=50,sa=2*I,na=()=>{var e=c((y.x-o)/I)*I,r=c((y.y-p)/I)*I,t=C((y.x+o)/I)*I,s=C((y.y+p)/I)*I;for(let a=e;a<t;a+=I)for(let e=r;e<s;e+=I)f(a,e,I,I,a%sa==0==(e%sa==0)?"#000":"#111")},da=.75,la=()=>{var e,a;0<y.ze&&(e=y.ze>da-.1?(da-y.ze)/.1:y.ze/(da-.1),ke(.5*e),(e=b.createRadialGradient(y.x,y.y,0,y.x,y.y,50)).addColorStop(0,"#ffff"),e.addColorStop(1,"#fff0"),ue(y.x,y.y,100,e),ke(1));for(a of y.Y)a.K.N(a,a.K.u[a.W]);y.K.N(y.x,y.y)},ia=()=>{for(var e of T){var a=e.K;a.N(e.x,e.y,0<e.P?g:void 0),a.ve&&ua(e.x-20,e.y+15,40,3,"#333",e.T,a.T,"#f33")}},oa=()=>{for(var e of ta)ue(e.x,e.y,10<=(e.re??0)?8:6,0<(e.T??0)?"#0c0":(e.re??0)<10?"#05f":"#ff0")},pa={h:"Base damage",$:"Attack speed",g:"Area",T:"Health",H:"Regen",De:"Armor",G:"Speed",j:"Health Drop",V:"Pickup Distance"},ma={$:e=>oe(2-e),T:c,g:oe,G:oe,H:e=>oe(e)+"/s",j:e=>i(100*e)+"%"},ca=(e,a)=>{var t,r=X(e.C).map(([e,a])=>[pa[e],(ma[e]??i)(a.A)]),s=r.push.bind(r);a&&(s([]),s(...X(e.K.ye).map(([e,a])=>[pa[e],i(z(a),2)+"/level"])),s([]));for(t of e.Y){let r=t.K.l;s([r+" level",t.W+1],...X(t.K.u[t.W]).filter(([e])=>!!we[e]).map(([e,a])=>[r+" "+we[e],(ye[e]??i)(a)]))}return r},ha=(e,a,r)=>Re(e,a,r,s-a-40,ca(y)),ga=(e,a,r)=>Re(e,a,r,s-a-40,[["Survived",le(E.Te)],["Level",y.W+1],["Damage",i(E.I)],["DPS",i(E.I/E.Te,2)],["Kills",E.ue]]),ua=(e,a,r,t,s,n,d,l,i,o=g)=>{f(e,a,r,t,s),f(e,a,n/d*r,t,l),i&&k(e+2,a+t/2,c(n)+"/"+c(d),o,Y,K)},va=()=>{var e,a,r,t;ua(50,0,m-50,20,"#600",y.T,y.C.T.A,"#f66",!0),ua(50,20,m-50,12,d,y.re,y.te,g,!0,"#000"),f(0,0,50,32,"#000"),k(25,2,"level","#666",n,l),k(25,18,""+(y.W+1),g,n,l),k(o,35,le(E.Te),g,n),E.Te<20&&U().map((e,a)=>e&&k(10,s-30-15*(U().length-a),e,g,Y,l)),S.ta&&(R(S.Je,S.Qe,xe,"#3335"),e=S.Ze-S.Je,a=S.ea-S.Qe,r=h(e,a),t=j(xe,r),R(S.Je+e/r*t,S.Qe+a/r*t,10,"#666"))},fa=(r,t,s,n,d,e)=>(e.map((e,a)=>{f(r,t,s,n,a===E.Ie?"#333":"#222",a===E.Ie?"#aa3":"#444"),d(r,t,e),t+=n+5}),t),ka=(e,a,r,t)=>{x.ta&&S.Ze>=e&&S.Ze<=e+r&&0<=(e=c((S.Qe-a)/(t+5)))&&e<=E.Me&&(E.Ie=e)},Ra=a=>y.me.filter(e=>e===a).length,ba={[P.de](){k(o,100,"YOU'RE DEAD!","#f88",n,l,24),k(o,ga(50,145,m-100)+75,B,g,n)},[P.le](){fe(40,"PAUSED"),ha(20,80,m-40)},[P.Pe](){fe(10,"PICK CLASS"),fa(20,50,100,20,(e,a,r)=>{r.N(e+10,a+10),k(e+20,a+10,r.l,g,Y,K)},D),Re(140,30,m-140-20,s-60,ca(y,!0),!1),te&&(f(20,s-80,100,30,"#333"),k(70,s-65,"START",g,n,K))},[P.ie](){fe(10,"LEVEL UP"),fa(20,50,m-40,40,(e,a,r)=>{k(e+5,a+5,r.l,g),k(e+5,a+22,"string"==typeof r.q?r.q:r.q(),G),k(e+m-50,a+20,Ra(r)+"/"+(r._??5),G,H,K)},E.me),ha(20,210,m-40)},[P.pe](){k(o,p-40,"MICRO",g,n,"bottom",68),k(o,p-40,"SURVIVORS",g,n,l,38),ke(.75+.25*q(Date.now()/1e3*5)),k(o,p+50,"Press ENTER to start",g,n),ke(1)},[P.Le](){k(o,100,"YOU WON",g,n,K),k(o,ga(70,130,m-140)+30,B,g,n)}},Sa=()=>{E.ge!==P.pe&&E.ge!==P.Pe&&va();var e=ba[E.ge];e&&(ge(),e())},xa=()=>{var e=j(1,y.ne/.5),e=(0<e&&(e=be(80,"#f000",`rgba(255,0,0,${e})`),ge(e)),j(1,y.oe/.1));0<e&&(e=be(130,"#fff0",`rgba(255,255,255,${.15*e})`),ge(e))},Da=(e,a,r,t)=>ta.push({x:e,y:a,re:t,T:r}),Aa=t=>{let s=0;var n,d=[];for(n of T){let r=n.K;if(n.T<=0)Da(n.x,n.y,0,r.re),Q()<y.C.j.A&&Da(n.x,n.y,5),E.ue+=1,d.push(s);else{n.P-=t;let e=n.He[0]*t,a=n.He[1]*t;var l,i=y.x-n.x,o=y.y-n.y,p=h(i,o);!n.ve&&3*m<p?d.push(s):(n.M<=0?(p<5+(n.K.S??5)-1&&(y.T-=ee(0,r.h-y.C.De.A),y.ne=.5,n.M=1,u(...v.Ce)),l=r.G*t,e+=i/p*l,a+=o/p*l):n.M-=t,n.x+=e,n.y+=a,n.He=n.He.map(e=>{var a=-W(e)*t*(r.Re??20);return z(a)>z(e)?0:e+a}))}s++}ce(T,d)},wa=e=>{var a=Q()*N,r=ee(m,s)/2,r=h(r,r)+15*Q();ra(y.x+q(a)*r,y.y+F(a)*r,e)},ya=e=>{Ne(e),_(E,We),E.ge=P.Oe,T.length=0,ta.length=0},Pa=()=>{x.u&&0<E.Ie&&(E.Ie--,u(...v.Ne)),x.d&&E.Ie<E.Me&&(E.Ie++,u(...v.Ne))},Ea=0,Ta=e=>{switch(E.ge){case P.Oe:E.Te+=e,x.p&&(E.ge=P.le),y.T<=0&&(E.ge=P.de);var a=c(E.Te/aa),r=Ze[a];E.Te>ea&&0===T.length&&(E.ge=P.Le),r&&(a!==E.ce&&(E.ce=a,r.ve&&wa(r.ve),r.ke?.()),a=r.xe??.205,0<r.be.length&&E.he>a&&(wa(r.be[Ea++%r.be.length]),E.he-=a),E.he+=e);break;case P.Le:case P.de:case P.pe:(S.e||x.ta)&&(E.Ie=0,E.Me=D.length-1,Ne(D[0]),E.ge=P.Pe,u(...v.Ne));break;case P.Pe:ka(20,50,100,20),Pa();r=D[E.Ie];y.K!==r&&Ne(r),x.e&&(ya(D[E.Ie]),u(...v.Ne)),x.ta&&20<=S.Je&&S.Je<=120&&S.Qe>s-80&&S.Qe<s-50&&ya(D[E.Ie]);break;case P.ie:ka(20,50,m-40,40),Pa(),(x.e||x.ta)&&((a=E.me[E.Ie]).X(),y.me.push(a),E.ge=P.Oe,u(...v.Ne));break;case P.le:(x.p||x.e)&&(E.ge=P.Oe)}},Ia=e=>{let a=Pe=0,r=0,t=(S.u&&--r,S.d&&(r+=1),S.l&&--a,S.r&&(a+=1),y.C.G.A*e);S.ta&&(i=S.Ze-S.Je,s=S.ea-S.Qe,n=h(i,s),a=i,r=s,t*=j(xe,n)/xe);var s,n,d,l,i=h(a,r);0<i&&(y.x+=a/i*t,y.y+=r/i*t),te?(s=T.reduce((e,a)=>{var r=h(y.x-a.x,y.y-a.y);return r<e.aa?{aa:r,ra:a}:e},{aa:1/0,ra:null})).ra&&(y.L=M(s.ra.y-y.y,s.ra.x-y.x)):y.L=M(S.Ve-o,S.Ye-p),y.re>=y.te&&(y.W+=1,y.re-=y.te,y.te+=10,y.ze=da,y.Xe++,y.T+=5,Te(75,(e,a)=>Ee(e,0,a,40)),u(...v.We)),0<y.ze&&(y.ze-=e,y.ze<=0)&&(n=Ce.filter(e=>Ra(e)<(e._??5)),E.me=pe(n,3,e=>e.Ae?.()??Ue),0<E.me.length&&(E.ge=P.ie,E.Ie=0,E.Me=E.me.length-1),y.Xe--,0<y.Xe)&&(y.ze=.5*da),y.ne-=e,y.oe-=e,y.T=j(y.C.T.A,y.T+y.C.H.A*e);for(d of y.Y)d.D+=e,d.M<=0?(l=d.K.u[d.W],d.K.D(d,l),d.M=l.R*y.C.$.A):d.M-=e},La=e=>{let a=0;var r,t=[];for(r of ta){var s,n=y.x-r.x,d=y.y-r.y,l=h(n,d);l<10?(y.T=j(y.C.T.A,y.T+(r.T??0)),y.re+=r.re??0,y.oe=.1,u(...v.Ue),t.push(a)):l<y.C.V.A&&(s=(y.C.V.A+10-l)*e*2,r.x+=n/l*s,r.y+=d/l*s),a++}ce(ta,t)},Oa=0,Ua=e=>{requestAnimationFrame(Ua);var a=(e-Oa)/1e3;Oa=e,b.reset(),b.clearRect(0,0,m,s),b.translate(-y.x+o,-y.y+p),na(),oa(),la(),ia(),b.resetTransform(),xa(),Sa(),e=a,Ta(e),E.ge===P.Oe&&(Aa(e),La(e),Ia(e)),x={}};return L.appendChild(r),requestAnimationFrame(Ua),[r,y,E,e=>re=e]}