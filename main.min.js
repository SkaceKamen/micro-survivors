function microSurvivors(M=document.body,p=400,s=400){let O="monospace",U=()=>["WASD to move",P.Y[0].K===Ee?"Mouse to aim":void 0,"Survive","Kill end boss"],i=p/2,m=s/2,{floor:c,ceil:C,random:J,round:Q,cos:q,sin:F,min:Z,hypot:h,abs:j,atan2:W,PI:z,max:ee,tan:ae,sign:N}=Math,l=2*z;var e="Press ENTER to ";let B=e+"restart",n="center",o="top",K="left",Y="right",H="middle",g="#fff",$="#aaa",G="#ccc",t="#faa",d="#0ac",u="#999",{entries:V,assign:X}=Object,_=0;let re=!1,te=.3,se=new AudioContext,v=(e=1,a=.05,r=220,t=0,s=0,n=.1,d=0,W=1,l=0,o=0,i=0,m=0,p=0,N=0,c=0,B=0,h=0,g=1,u=0,v=0,f=0)=>{let k=2*z,b=44100,K=l*=500*k/b/b,R=r*=(1-a+2*a*J(a=[]))*k/b,S=0,Y=0,x=0,D=1,H=0,$=0,A=0,y=f<0?-1:1,w=k*y*f*2/b,P=q(w),E=F,T=E(w)/4,I=1+T,G=-2*P/I,V=(1-T)/I,L=(1+y*P)/2/I,X=-(y+P)/I,_=L,M=0,O=0,U=0,C=0;for(t=b*t+9,u*=b,s*=b,n*=b,h*=b,o*=500*k/b**3,c*=k/b,i*=k/b,m*=b,p=b*p|0,e*=te,y=t+u+s+n+h|0;x<y;a[x++]=A*e)++$%(100*B|0)||(A=d?1<d?2<d?3<d?E(S**3):ee(Z(ae(S),1),-1):1-(2*S/k%2+2)%2:1-4*j(Q(S/k)-S/k):E(S),A=(p?1-v+v*E(k*x/p):1)*(A<0?-1:1)*j(A)**W*(x<t?x/t:x<t+u?1-(x-t)/u*(1-g):x<t+u+s?g:x<y-h?(y-x-h)/n*g:0),A=h?A/2+(h>x?0:(x<y-h?1:(y-x)/h)*a[x-h|0]/2/e):A,f&&(A=C=_*M+X*(M=O)+L*(O=A)-V*U-G*(U=C))),w=(r+=l+=o)*q(c*Y++),S+=w+w*N*E(x**5),D&&++D>m&&(r+=i,R+=i,D=0),!p||++H%p||(r=R,l=K,D=D||1);(e=se.createBuffer(1,y,b)).getChannelData(0).set(a),(r=se.createBufferSource()).buffer=e,r.connect(se.destination),r.start()},f={Ne:[3,,42,.01,.01,.02,3,2,,2,,,,,193,.6,,.53,.02],Ue:[.2,,577,,.05,.09,,3.6,,,,,,,,,,.64,.03,,-1499],We:[.6,,599,.06,.11,.17,,1.2,-1,-5,254,.06,.1,.1,12,,,.86,.25,,-972],Be:[.3,,142,,.23,.5,1,,-2.6,-24,,,.09,,,,,.1,.06],Ce:[.7,,480,.02,.04,.18,3,2.3,,,,,,.6,,.4,,.85,.01,,99]},ne=(e,a=2,r="0")=>e.toString().padStart(a,r),de=e=>ne(c(e/60))+":"+ne(c(e%60)),le=e=>k(e*(180/z))+"Â°",k=(e,a=0)=>e?.toFixed(a)??"",oe=e=>k(e,2);let ie=(e,a,r)=>{for(var t=[];e.length&&a--;){var s=me(e,r);t.push(e[s]),e.splice(s,1)}return t},me=(r,t)=>{var e=r.map(t).reduce((e,a)=>e+a),s=J()*e;for(let e=0,a=0;;e++)if(s<=(a+=t(r[e])))return e};let pe=e=>x.fillStyle=e,b=(e,a,r,t,s,n)=>{x[n?"strokeStyle":"fillStyle"]=s,x[n?"strokeRect":"fillRect"](e,a,r,t)},ce=(e="#000d")=>{b(0,0,p,s,e)},he=(e,a,r,t)=>{pe(t),x.fillRect(e-r/2,a-r/2,r,r)},ge=(e,a,r,t)=>{pe(t),x.beginPath(),x.moveTo(e,a-r/2),x.lineTo(e-r/2,a+r/2),x.lineTo(e+r/2,a+r/2),x.fill()},R=(e,a,r,t,s=K,n=o,d=14)=>{x.font=d+"px "+O,pe(t),x.textAlign=s,x.textBaseline=n,x.fillText(r,e,a)},ue=(e,a)=>{R(i,e,a,g,n,o)},S=(e,a,r,t)=>{pe(t),x.beginPath(),x.arc(e,a,r,0,l),x.fill()},ve=e=>x.globalAlpha=e,fe=(e,a,r,t,s,n=!0)=>{var d,l,o=a,i=n?r/2:r;n&&15*(s.length-1)<=t&&(e+=r/4);for([d,l]of s)(d||l)&&(R(e,a,d+":",$),R(e+i-5,a,""+l,g,Y)),o+t<(a+=15)&&(a=o,e+=i);return a},ke=(e,a,r)=>{e=x.createRadialGradient(i,m,e,i,m,i);return e.addColorStop(0,a),e.addColorStop(1,r),e},r=document.createElement("canvas"),x=(r.width=p,r.height=s,r.getContext`2d`),be={38:"u",40:"d",37:"l",39:"r",87:"u",83:"d",65:"l",68:"r",13:"e",69:"e",27:"p",80:"p"},D={u:!1,d:!1,l:!1,r:!1,e:!1,p:!1,Ye:0,Ve:0,touched:!1,Je:0,Qe:0,Ze:0,ea:0},Re=60,A={};e=r=>e=>{var a=be[e.which];a&&(e.preventDefault(),D[a]=r,A[a]=r)};let Se=e=>{var a=r.getBoundingClientRect();return{x:(e.clientX-a.left)*(1/_),y:(e.clientY-a.top)*(1/_)}},xe=(onkeydown=e(!0),onkeyup=e(!1),onmousemove=e=>{e=Se(e);D.Ye=e.x,D.Ve=e.y},onblur=()=>{T.ge===E.Oe&&(T.ge=E.le)},ontouchstart=e=>{A.e=!0,D.touched=!0;e=Se(e.touches[0]);D.Je=e.x,D.Qe=e.y,re=!0},ontouchmove=e=>{e=Se(e.touches[0]);D.Ze=e.x,D.ea=e.y},ontouchend=()=>{D.touched=!1},{h:"damage",g:"area",v:"speed",Ee:"orbs",S:"radius",_e:"angle"}),De={v:e=>le(e)+"/s",_e:le};e=e=>{let r=e[0];return e.map((e,a)=>0===a?r:(a=V(e).map(([e,a])=>`+${(De[e]??k)(a-r[e])} `+xe[e]).join(", "),{...r={...r,...e},q:a}))};let Ae=0,ye=(e,a,r,t=20)=>{e.T-=a,e.P=.1,t&&(e.He=[q(r)*t,F(r)*t]),Ae++<4&&v(...f.Be),T.I+=a},we=(e,a,r,t)=>{for(var s of I){var n=s.x-(r??P.x),d=s.y-(t??P.y),l=h(n,d),d=W(d,n);l<e+(s.K.S??5)&&a(s,d,l)}},Pe=(a,e,r)=>{var t=a.g,s=e*(a.v*(2-P.C.$.A)),n=l/a.Ee;for(let e=0;e<a.Ee;e++){var d=s+n*e;r(P.x+q(d)*t,P.y+F(d)*t,d)}};var a={l:"Orbs",u:e([{h:10,g:50,v:z/1.5,R:.1,Ee:1,S:10,q:"Orbiting orbs"},{Ee:2},{h:15,v:z/1.25},{v:+z,S:15},{Ee:3},{h:20},{Ee:4}]),D(e,a){let t=a.h+P.C.h.A,s=a.S*P.C.g.A;Pe(a,e.D,(e,a,r)=>we(s/2,e=>ye(e,t,r),e,a))},N(e,a){let r=a.S*P.C.g.A;Pe(a,e.D,(e,a)=>S(e,a,r/2,g))}};let Ee={l:"Sword",u:e([{h:8,_e:z/4,g:80,R:.5,q:"Melee weapon"},{h:13},{_e:z/4*1.2,g:90},{h:18},{h:23},{h:28,_e:z/4*1.5},{h:33,_e:z/4*1.7,g:120}]),D(e,a){let t=a.h+P.C.h.A,s=a._e/2*P.C.g.A;we(a.g,(e,a,r)=>{r=W((e.K.S??5)/2,r);j((a-P.L+z)%l-z)<s+r&&ye(e,t,a)})},N(e,a){var r=a.R*P.C.$.A,t=a.g,e=.2*(e.M/r);0<e&&(r=a._e/2*P.C.g.A,pe(`rgba(255,255,255,${e})`),x.beginPath(),x.moveTo(P.x,P.y),x.lineTo(P.x+q(P.L-r)*t,P.y+F(P.L-r)*t),x.arc(P.x,P.y,t,P.L-r,P.L+r),x.lineTo(P.x,P.y),x.fill())}};e={l:"Barbed Wire",u:e([{g:40,h:2,R:.75,q:"Area damage"},{g:60},{h:3},{g:70},{g:80},{h:4}]),D(e,a){let r=a.h+P.C.h.A;a=a.g*P.C.g.A;we(a,(e,a)=>ye(e,r,a,0))},N(e,a){var r=a.R*P.C.$.A,a=a.g*P.C.g.A,e=e.M/r,r=.15+.04*q(2*e*z);S(P.x,P.y,a,`rgba(255,0,0,${r})`)}};let Te=e=>({K:e,D:0,M:0,W:0}),Ie=[{l:"Warrior",Ke:Ee,C:{T:75,G:45,H:.05,V:50,h:0,$:1,j:.01,De:1,g:1},ye:{G:.2,H:.025,h:.3},N:(e,a)=>he(e,a,10,g)},{l:"Monk",Ke:e,C:{T:75,G:60,H:.05,V:50,h:0,$:1,j:.01,De:0,g:1},ye:{H:.03,V:1,g:.025},N:(e,a)=>ge(e,a,10,g)},{l:"Magic Man",Ke:a,C:{T:75,G:45,H:.05,V:50,h:0,$:1,j:.01,De:0,g:1},ye:{G:.2,$:-.026,H:.03,De:.25,g:.02},N:(e,a)=>S(e,a,5,g)}],Le=100;var y=a=>({l:a.l,q:()=>{var e=P.Y.find(e=>e.K===a);return a.u[(e?.W??-1)+1].q??""},X(){var e=P.Y.find(e=>e.K===a);e?e.W++:P.Y.push(Te(a))},Ae:()=>P.Y.some(e=>e.K===a)?Le:15,_:a.u.length-1});let Me=[{l:"Speed boost",q:"+5% speed",X(){P.C.G.J+=.05}},{l:"Speed base",q:"+1 base speed",X(){P.C.G.Z+=1}},{l:"Max health",q:"+25 max health, +5 health",X(){P.C.T.Z+=25,P.T+=5}},{l:"Health drop",q:"+1% health drop chance",X:()=>P.C.j.Z+=.01},{l:"Regen",q:"+0.05/s health regen",X:()=>P.C.H.Z+=.05},{l:"Regen boost",q:"+10% health regen",X:()=>P.C.H.J+=.1},{l:"Pickup range",q:"+10 pickup range",X:()=>P.C.V.Z+=10},{l:"Damage",q:"+1 damage",X:()=>P.C.h.Z+=1},{l:"Attack speed",q:"+5% attack speed",X:()=>P.C.$.Z-=.05},{l:"Armor",q:"+1 armor",X:()=>P.C.De.Z+=1},{l:"Area",q:"+10% area",X:()=>P.C.g.Z+=.1},y(a),y(Ee),y(e)],w=(e=0,a=0,r=1)=>({Z:e,J:r,get A(){return(this.Z+P.W*a)*this.J}}),Oe=e=>({K:e,x:0,y:0,W:0,re:0,te:5,T:e.C.T,se:0,ne:0,oe:0,L:0,ze:0,Xe:0,C:{T:w(e.C.T,e.ye.T),H:w(e.C.H,e.ye.H),De:w(e.C.De,e.ye.De),h:w(e.C.h,e.ye.h),$:w(e.C.$,e.ye.$),g:w(e.C.g,e.ye.g),G:w(e.C.G,e.ye.G),V:w(e.C.V,e.ye.V),j:w(e.C.j,e.ye.j)},me:[],Y:[Te(e.Ke)]}),P=Oe(Ie[0]),E={Oe:0,de:1,ie:2,le:3,Le:4,pe:5,Pe:6},Ue={ce:-1,Te:0,I:0,ue:0,he:0,me:[],Ie:0,Me:0},T={ge:E.pe,...Ue},Ce=e=>X(P,Oe(e));var a=(e,n)=>(r,t,s)=>e.map((e,a)=>he(r+2*a,t+2*a,n,s??e)),y=(e,n)=>(r,t,s)=>e.map((e,a)=>ge(r+2*a,t+2*a,n,s??e)),e=(e,n)=>(r,t,s)=>e.map((e,a)=>S(r+2*a,t+2*a,n,s??e)),We={T:10,G:26,h:8,re:1,N:a([$],10)},Ne={T:50,G:26,h:12,re:2,N:a([$,t],10)},Be={T:100,G:30,h:15,re:3,N:a([$,t,"#4a4"],10)},Ke={T:1e3,G:30,h:15,re:100,S:20,N:a([t],20),ve:!0},a={T:100,G:16,h:6,re:1,N:a([u],10)},Ye={T:20,G:35,h:8,re:2,N:y([u],10)},He={T:40,G:35,h:10,re:3,N:y([u,d],10)},$e={T:60,G:35,h:12,re:4,N:y([u,d,"#966"],10)},Ge={T:220,G:20,h:10,re:4,N:y([u,u,u],10)},y={T:3e3,G:35,h:20,re:200,ve:!0,Re:80,S:10,N:y([t],20)},Ve={T:10,G:40,h:8,re:3,N:e([u],5)},Xe={T:20,G:40,h:10,re:4,N:e([u,d],5)},_e={T:50,G:40,h:12,re:5,N:e([u,d,"#4ca"],5)},qe={T:200,G:25,h:12,re:4,S:8,N:e([d],8)},e={T:5e3,G:50,h:25,re:300,ve:!0,Re:80,S:15,N:e([t],15)};let Fe=(r,e,t=1)=>Array.from({length:c((e-r)/t)}).map((e,a)=>a*t+r);var je,ze=r=>()=>{var e=2*(r.S??5),a=Fe(P.x-i,P.x+i,4+e),e=Fe(P.y-m,P.y+m,4+e);a.map(e=>ea(e,P.y-m,r)),a.map(e=>ea(e,P.y+m,r)),e.map(e=>ea(P.x-i,e,r)),e.map(e=>ea(P.x+i,e,r))};let Je=[{be:[We]},{be:[We,Ye]},{be:[Ye,Ve],ve:Ke},{be:[Ye,Ve]},{be:[Ne],ke:ze(a)},{be:[Ne,He,Ve]},{be:[He,Ve],ve:y},{be:[Ne,He,Xe]},{be:[Xe,Be],ke:(je=qe,()=>{var e=l/40;Fe(0,l,e).map(e=>ea(P.x+q(e)*i,P.y+F(e)*m,je))})},{be:[Be,$e]},{be:[Be,$e]},{be:[Be,$e,_e]},{be:[Be,$e],ve:e},{be:[Be,$e,_e],xe:.1,ke:ze(Ge)},{be:[],ve:{T:8e3,G:65,h:55,re:0,ve:!0,Re:1e3,S:25,N(e,a,r){S(e,a,25,r??t),he(e,a,25,r??d),ge(e,a,23,r??t)}}}],Qe=600,Ze=Qe/(Je.length-1),ea=(e,a,r)=>I.push({x:e,y:a,K:r,T:r.T,M:0,He:[0,0],P:0,ve:!!r.ve}),I=[],aa=[],L=50,ra=2*L,ta=()=>{var e=c((P.x-i)/L)*L,r=c((P.y-m)/L)*L,t=C((P.x+i)/L)*L,s=C((P.y+m)/L)*L;for(let a=e;a<t;a+=L)for(let e=r;e<s;e+=L)b(a,e,L,L,a%ra==0==(e%ra==0)?"#000":"#111")},sa=.75,na=()=>{var e,a;0<P.ze&&(e=P.ze>sa-.1?(sa-P.ze)/.1:P.ze/(sa-.1),ve(.5*e),(e=x.createRadialGradient(P.x,P.y,0,P.x,P.y,50)).addColorStop(0,"#ffff"),e.addColorStop(1,"#fff0"),he(P.x,P.y,100,e),ve(1));for(a of P.Y)a.K.N(a,a.K.u[a.W]);P.K.N(P.x,P.y)},da=()=>{for(var e of I){var a=e.K;a.N(e.x,e.y,0<e.P?g:void 0),a.ve&&ha(e.x-20,e.y+15,40,3,"#333",e.T,a.T,"#f33")}},la=()=>{for(var e of aa)he(e.x,e.y,10<=(e.re??0)?8:6,0<(e.T??0)?"#0c0":(e.re??0)<10?"#05f":"#ff0")},oa={h:"Base damage",$:"Attack speed",g:"Area",T:"Health",H:"Regen",De:"Armor",G:"Speed",j:"Health Drop",V:"Pickup Distance"},ia={$:e=>oe(2-e),T:c,g:oe,G:oe,H:e=>oe(e)+"/s",j:e=>k(100*e)+"%"},ma=(e,a)=>{var t,r=V(e.C).map(([e,a])=>[oa[e],(ia[e]??k)(a.A)]),s=r.push.bind(r);a&&(s([]),s(...V(e.K.ye).map(([e,a])=>[oa[e],k(j(a),2)+"/level"])),s([]));for(t of e.Y){let r=t.K.l;s([r+" level",t.W+1],...V(t.K.u[t.W]).filter(([e])=>!!xe[e]).map(([e,a])=>[r+" "+xe[e],(De[e]??k)(a)]))}return r},pa=(e,a,r)=>fe(e,a,r,s-a-40,ma(P)),ca=(e,a,r)=>fe(e,a,r,s-a-40,[["Survived",de(T.Te)],["Level",P.W+1],["Damage",k(T.I)],["DPS",k(T.I/T.Te,2)],["Kills",T.ue]]),ha=(e,a,r,t,s,n,d,l,o,i=g)=>{b(e,a,r,t,s),b(e,a,n/d*r,t,l),o&&R(e+2,a+t/2,c(n)+"/"+c(d),i,K,H)},ga=()=>{var e,a,r,t;ha(50,0,p-50,20,"#600",P.T,P.C.T.A,"#f66",!0),ha(50,20,p-50,12,u,P.re,P.te,g,!0,"#000"),b(0,0,50,32,"#000"),R(25,2,"level","#666",n,o),R(25,18,""+(P.W+1),g,n,o),R(i,35,de(T.Te),g,n),T.Te<20&&U().map((e,a)=>e&&R(10,s-30-15*(U().length-a),e,g,K,o)),D.touched&&(S(D.Je,D.Qe,Re,"#3335"),e=D.Ze-D.Je,a=D.ea-D.Qe,r=h(e,a),t=Math.min(Re,r),S(D.Je+e/r*t,D.Qe+a/r*t,10,"#666"))},ua=(a,r,t,s,n,d)=>{for(let e=0;e<d.length;e++)b(a,r,t,s,e===T.Ie?"#333":"#222"),b(a,r,t,s,e===T.Ie?"#aa3":"#444",!0),n(a,r,d[e]),r+=s+5;return r},va=a=>P.me.filter(e=>e===a).length,fa={[E.de](){var e;R(i,100,"YOU'RE DEAD!","#f88",n,o,24),e=ca(50,145,p-100),R(i,e+75,B,g,n)},[E.le](){ue(40,"PAUSED"),pa(20,80,p-40)},[E.Pe](){ue(10,"PICK CLASS"),ua(20,50,100,20,(e,a,r)=>{r.N(e+10,a+10),R(e+20,a+10,r.l,g,K,H)},Ie),fe(140,30,p-140-20,s-60,ma(P,!0),!1)},[E.ie](){ue(10,"LEVEL UP"),ua(20,50,p-40,40,(e,a,r)=>{var t=va(r);R(e+5,a+5,r.l,g),R(e+5,a+22,"string"==typeof r.q?r.q:r.q(),G),R(e+p-50,a+20,t+"/"+(r._??5),G,Y,H)},T.me),pa(20,210,p-40)},[E.pe](){R(i,m-40,"MICRO",g,n,"bottom",68),R(i,m-40,"SURVIVORS",g,n,o,38),R(i,s-5,"by SkaceKamen",G,n,"bottom",10),ve(.75+.25*q(performance.now()/1e3*5)),R(i,m+50,"Press ENTER to start",g,n),ve(1)},[E.Le](){R(i,100,"YOU WON",g,n,H);var e=ca(70,130,p-140);e+=30,R(i,e,B,g,n)}},ka=()=>{T.ge!==E.pe&&T.ge!==E.Pe&&ga();var e=fa[T.ge];e&&(ce(),e())},ba=()=>{var e=Z(1,P.ne/.5),e=(0<e&&(e=ke(80,"#f000",`rgba(255,0,0,${e})`),ce(e)),Z(1,P.oe/.1));0<e&&(e=ke(130,"#fff0",`rgba(255,255,255,${.15*e})`),ce(e))},Ra=(e,a,r,t)=>aa.push({x:e,y:a,re:t,T:r}),Sa=t=>{let s=0;var n,d=[];for(n of I){let r=n.K;if(n.T<=0)Ra(n.x,n.y,0,r.re),J()<P.C.j.A&&Ra(n.x,n.y,5),T.ue+=1,d.push(s);else{n.P-=t;let e=n.He[0]*t,a=n.He[1]*t;var l,o=P.x-n.x,i=P.y-n.y,m=h(o,i);!n.ve&&3*p<m?d.push(s):(n.M<=0?(m<5+(n.K.S??5)-1&&(P.T-=ee(0,r.h-P.C.De.A),P.ne=.5,n.M=1,v(...f.Ce)),l=r.G*t,e+=o/m*l,a+=i/m*l):n.M-=t,n.x+=e,n.y+=a,n.He=n.He.map(e=>{var a=-N(e)*t*(r.Re??20);return j(a)>j(e)?0:e+a}))}s++}let a=0;for(let e of d)I.splice(e-a,1),a+=1},xa=e=>{var a=J()*l,r=ee(p,s)/2,r=h(r,r)+15*J();ea(P.x+q(a)*r,P.y+F(a)*r,e)},Da=e=>{Ce(e),X(T,Ue),T.ge=E.Oe,I.length=0,aa.length=0},Aa=()=>{A.u&&0<T.Ie&&(T.Ie--,v(...f.Ne)),A.d&&T.Ie<T.Me&&(T.Ie++,v(...f.Ne))},ya=0,wa=e=>{switch(T.ge){case E.Oe:T.Te+=e,A.p&&(T.ge=E.le),P.T<=0&&(T.ge=E.de);var a=c(T.Te/Ze),r=Je[a];T.Te>Qe&&0===I.length&&(T.ge=E.Le),r&&(a!==T.ce&&(T.ce=a,r.ve&&xa(r.ve),r.ke?.()),a=r.xe??.205,0<r.be.length&&T.he>a&&(xa(r.be[ya++%r.be.length]),T.he-=a),T.he+=e);break;case E.Le:case E.de:case E.pe:D.e&&(T.Ie=0,T.Me=Ie.length-1,Ce(Ie[0]),T.ge=E.Pe,v(...f.Ne));break;case E.Pe:Aa();r=Ie[T.Ie];P.K!==r&&Ce(r),A.e&&(Da(Ie[T.Ie]),v(...f.Ne));break;case E.ie:Aa(),A.e&&((a=T.me[T.Ie]).X(),P.me.push(a),T.ge=E.Oe,v(...f.Ne));break;case E.le:(A.p||A.e)&&(T.ge=E.Oe)}},Pa=e=>{let a=Ae=0,r=0,t=(D.u&&--r,D.d&&(r+=1),D.l&&--a,D.r&&(a+=1),P.C.G.A*e);D.touched&&(o=D.Ze-D.Je,s=D.ea-D.Qe,n=h(o,s),a=o,r=s,t=Math.min(Re,n)/Re*t);var s,n,d,l,o=h(a,r);0<o&&(P.x+=a/o*t,P.y+=r/o*t),re&&(s={aa:1/0,ra:null},(n=I.reduce((e,a)=>{var r=a.x-P.x,t=a.y-P.y,r=h(r,t);return r<e.aa?{aa:r,ra:a}:e},s)).ra)&&(P.L=W(n.ra.y-P.y,n.ra.x-P.x)),P.L=W(D.Ve-i,D.Ye-m),P.re>=P.te&&(P.W+=1,P.re-=P.te,P.te+=10,P.ze=sa,P.Xe++,we(75,(e,a)=>ye(e,0,a,40)),v(...f.We),P.T+=5),0<P.ze&&(P.ze-=e,P.ze<=0)&&(o=Me.filter(e=>va(e)<(e._??5)),T.me=ie(o,3,e=>e.Ae?.()??Le),0<T.me.length&&(T.ge=E.ie,T.Ie=0,T.Me=T.me.length-1),P.Xe--,0<P.Xe)&&(P.ze=.5*sa),0<P.ne&&(P.ne-=e),0<P.oe&&(P.oe-=e),P.T=Z(P.C.T.A,P.T+P.C.H.A*e);for(d of P.Y)d.D+=e,d.M<=0?(l=d.K.u[d.W],d.K.D(d,l),d.M=l.R*P.C.$.A):d.M-=e},Ea=e=>{let a=0;var r,t=[];for(r of aa){var s,n=P.x-r.x,d=P.y-r.y,l=h(n,d);l<10?(P.T=Z(P.C.T.A,P.T+(r.T??0)),P.re+=r.re??0,P.oe=.1,v(...f.Ue),t.push(a)):l<P.C.V.A&&(s=(P.C.V.A+10-l)*e*2,r.x+=n/l*s,r.y+=d/l*s),a++}let o=0;for(let e of t)aa.splice(e-o,1),o+=1},Ta=0,Ia=e=>{requestAnimationFrame(Ia);var a=(e-Ta)/1e3;Ta=e,x.reset(),x.clearRect(0,0,p,s),x.translate(-P.x+i,-P.y+m),ta(),la(),na(),da(),x.resetTransform(),ba(),ka(),e=a,wa(e),T.ge===E.Oe&&(Sa(e),Ea(e),Pa(e)),A={}};return M.appendChild(r),requestAnimationFrame(Ia),[r,P,T,e=>_=e]}